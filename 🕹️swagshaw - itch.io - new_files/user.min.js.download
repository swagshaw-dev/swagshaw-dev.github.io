(()=>{var T=function(r,e){for(var t in e)U.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r},U={}.hasOwnProperty;I.UserHeader=function(r){T(e,r);function e(){e.__super__.constructor.apply(this,arguments),this.el.dispatch("click",{edit_theme_btn:function(t){return function(){return t.toggle_theme_editor()}}(this)}),window.location.hash.match(/\bedit_theme\b/)&&_.defer(function(t){return function(){return t.toggle_theme_editor()}}(this))}return e.prototype.toggle_theme_editor=function(){var t;return t=!I.theme_editor.state.open,I.theme_editor.setState({open:t}),$(document.body).toggleClass("theme_editor_open",t)},e}(I.Header);var M,v=M=window.$,w=window.I,y=w.ReferrerTracker||(w.ReferrerTracker=function(){function r(){}return r.MAX_ITEMS=20,r.get_cookie=function(){return window.Cookies.getJSON("itchio_refs")||[]},r.write_cookie=function(e){return w.set_cookie("itchio_refs",e,{expires:14})},r.has_ref=function(e,t){var n,u,o,l,f,h;for(t=+t,f=r.get_cookie(),o=0,l=f.length;o<l;o++)if(h=f[o],u=h[0],n=h[1],u===e&&n===t)return!0;return!1},r.push=function(e,t,n){var u,o;if(n&&n.length>0){for(t=+t,o=function(){var l,f,h,d;for(h=this.get_cookie(),d=[],l=0,f=h.length;l<f;l++)u=h[l],!(u[0]===e&&u[1]===t)&&d.push(u);return d}.call(r),w.in_dev&&console.log("pushing referrer",[e,t,n]),o.unshift([e,t,n]);o.length>r.MAX_ITEMS;)o.pop();return r.write_cookie(o)}},r}()),S=function(r,e){var t;return t=function(n){var u,o,l,f;if(n.closest(".game_author").length||(u=n.closest("[data-game_id]").data("game_id"))&&y.push("game",u,e(n)),!n.closest(".sale_author").length&&(o=n.closest("[data-sale_id]"),l=o.data("sale_id")))return f=o.data("sale_type"),y.push(f,l,e(n))},r.on("mouseup",".game_cell a, .sale_row a, .leader_game a",function(n){if(!(n.which>3))return t(v(n.currentTarget))}),r.on("i:track_link",function(n){return t(v(n.target))})};I.UserPage=function(){r.prototype.sticky_selector=".profile_column, .game_column";function r(e,t){var n;this.opts=t,this.el=$(e),this.opts.queue_url&&(n=window.parent)!=null&&n.postMessage({page_url:window.location.href,queue_url:this.opts.queue_url},"*"),this.setup_grid(),this.setup_tracking(),this.opts.ac&&I.setup_affiliate_code(this.opts.ac)}return r.prototype.setup_grid=function(){var e,t;return e=function(n){return function(){return $(window).width()<500?10:20}}(this),new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".mode_grid .user_game_grid",cell_margin:e,min_columns:2}),this.grid=new I.GameGrid(this.el.find(".user_game_grid"),{sizer:!1,show_popups:!1}),new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".game_grid_widget.game_list",cell_margin:e,expected_size:250,min_columns:2}),t=$(".purchased_games, .collections"),t.lazy_images({}),new I.GameCells(t)},r.prototype.setup_tracking=function(){return S(this.el,function(e){return function(){return"user:"+e.opts.user_id}}(this)),I.tracked_links(this.el,"user")},r}(),I.UserUserTools=function(){function r(e){this.el=$(e),I.tracked_links(this.el,"view_user","user_tools"),I.has_follow_button(this.el),setTimeout(function(t){return function(){return t.el.removeClass("hidden")}}(this),200)}return r}(),I.UserLayout=function(){function r(e){this.el=$(e),$(".user_page_wrap").max_height($(".header_widget").outerHeight(!0)||0),new I.UserUserTools(this.el.find(".user_tools"))}return r}();var k=window.React,G=window.ReactDOM,b=window.ReactDOMFactories,O=window.ReactTransitionGroup,P=window.PropTypes,D=window.classNames,x=window.R;k||w.libs.react.done(function(){return k=window.React,G=window.ReactDOM,b=window.ReactDOMFactories,O=window.ReactTransitionGroup,P=window.PropTypes,D=window.classNames,x=window.R}),I.libs.react.done(function(){var r,e,t,n,u,o,l,f,h;return e=b,l=e.select,o=e.option,f=e.strong,u=e.label,n=e.div,t=e.a,r=R.package("User"),h=PropTypes,r("ToolTags",{getInitialState:function(){return{selected_tags:$.extend({},this.props.default_tags)}},componentDidMount:function(){},tags_by_id:function(){return this._tags_by_id?this._tags_by_id:(this._tags_by_id={},this.props.tag_groups.forEach(function(d){return function(a){return a.tags.forEach(function(i){return i.group=a,d._tags_by_id[""+i.id]=i})}}(this)),this._tags_by_id)},select_tag:function(d){var a,i,c,p,s,g,m;for(g=$.extend({},this.state.selected_tags),m=this.tags_by_id()[d],s=m.group.tags,i=0,c=s.length;i<c;i++)p=s[i],delete g[p.id];return g[m.id]=!0,this.setState({selected_tags:g}),typeof(a=this.props).on_select_tags=="function"?a.on_select_tags(g):void 0},unselect_group:function(d){var a,i,c,p,s,g;for(s=$.extend({},this.state.selected_tags),p=d.tags,i=0,c=p.length;i<c;i++)g=p[i],delete s[g.id];return this.setState({selected_tags:s}),typeof(a=this.props).on_select_tags=="function"?a.on_select_tags(s):void 0},render:function(){var d;return d=this.props.tag_groups.map(function(a){return function(i){var c,p;if(p=i.tags.find(function(s){if(a.state.selected_tags[s.id])return!0}),c=i.tags.map(function(s){return{name:s.name,value:s.id}}),!!c.length)return c.unshift({name:"Any",value:""}),R.Forms.SimpleSelect({key:i.slug,name:i.slug,value:(p!=null?p.id:void 0)||"default",render_current_option:function(s){return s.value===""?i.name:f({},s.name)},onChange:function(s){var g;return g=a.tags_by_id()[s],g?a.select_tag(g.id):a.unselect_group(i)},options:c})}}(this)),this.enclose({},u({},"Filter games"),d,$.isEmptyObject(this.state.selected_tags)?void 0:n({className:"clear_area"},t({href:"#",onClick:function(a){return function(i){var c;return i.preventDefault(),a.setState({selected_tags:{}}),typeof(c=a.props).on_select_tags=="function"?c.on_select_tags({}):void 0}}(this)},"Clear filters")))}})})})();
